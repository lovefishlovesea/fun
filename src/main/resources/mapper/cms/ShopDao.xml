<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.lsd.fun.modules.cms.dao.ShopDao">

    <!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="com.lsd.fun.modules.cms.entity.ShopEntity" id="shopMap">
        <result property="id" column="id"/>
        <result property="title" column="title"/>
        <result property="description" column="description"/>
        <result property="remarkScore" column="remark_score"/>
        <result property="pricePerMan" column="price_per_man"/>
        <result property="province" column="province"/>
        <result property="city" column="city"/>
        <result property="region" column="region"/>
        <result property="address" column="address"/>
        <result property="categoryId" column="category_id"/>
        <result property="tags" column="tags"/>
        <result property="createdAt" column="created_at"/>
        <result property="updatedAt" column="updated_at"/>
        <result property="sellerId" column="seller_id"/>
        <result property="coverFileId" column="cover_file_id"/>
        <result property="disabledFlag" column="disabled_flag"/>
    </resultMap>

    <select id="queryPage" resultType="com.lsd.fun.modules.cms.dto.ShopVO">
        select shop.id,
               shop.title,
               shop.description,
               shop.remark_score,
               shop.price_per_man,
               shop.province,
               shop.city,
               shop.region,
               shop.address,
               shop.category_id,
               shop.tags,
               shop.created_at,
               shop.updated_at,
               shop.seller_id,
               shop.disabled_flag,
               category.name as category,
               seller.name   as seller,
               cover.path    as cover_url,
               cover.is_crawl
        from shop
                 left join category on category.id = shop.category_id
                 left join seller on seller.id = shop.seller_id
                 left join t_file cover on cover.id = shop.cover_file_id
            ${ew.customSqlSegment}
    </select>

</mapper>
